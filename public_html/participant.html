<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Participant</title>
      <!-- Specify the favicon -->
      <link rel="icon" type="image/png" href="1426963167.png">
      <!-- Bootstrap CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      <link rel="stylesheet" href="styles.css">
      <!-- Popup box -->
      <link rel="stylesheets" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
   </head>
   <body>
      <nav class="navbar navbar-light">
         <div class="container-fluid" >
            <a class="navbar-brand" href="index.html" style="background-color: transparent; color: black;  color: #741736; border-color: #741736;">
            <img src="1426963167.png" alt="" width="30" height="24" class="d-inline-block align-text-top">
            Home
            </a>
            <div class="center">
               <button onclick="goBack()" style="background-color: #741736; border: none; color: white;">
               Go Back
               </button>
            </div>
            <div class="center">
               <button onclick="instruction()" style="background-color: #741736; border: none; color: white;">
               Instructions
               </button>
            </div>            
         </div>
      </nav>
      <!--  -->
      <div id="popupModal" class="modal fade" role="dialog">
         <div class="modal-dialog">
             <div class="modal-content">
                 <div class="modal-header">
                     <h2>Instructions</h2>
                 </div>
                 <div class="modal-body">
                     <p>
                         Welcome to the auditory categorization training program! Before we dive into the main training sessions, let's ensure you're familiar with the procedure. Click on the Pre-Training to begin.
                     </p>
                 </div>
                 <div class="modal-footer">
                  <button type="button" class="btn btn-danger" data-dismiss="modal" style="background-color: #741736; border: none; color: white;">Close</button>
                 </div>
             </div>
         </div>
     </div>
      <div class="center">
            <a id="preTraining" class="card" href="/participant-tests/pre-training.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Pre Training</h5>
                </div>
            </a>
            <a id="preSymmetry" class="card" href="participant-tests/symmetry-pretest.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Symmetry Pretest</h5>
                </div>
            </a>
            <a id="preTrans" class="card" href="participant-tests/transitivity-pretest.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Transitivity Pretest</h5>
                </div>
            </a>
            <a id="BL" class="card" href="participant-tests/baseline-training.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Baseline Training</h5>
                </div>
            </a>
            <a id="BLTest" class="card" href="participant-tests/baseline-test.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Baseline Test</h5>
                </div>
            </a>
            <a id="Symmetry" class="card" href="participant-tests/symmetry-test.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Symmetry Test</h5>
                </div>
            </a>
            <a id="Trans" class="card" href="participant-tests/transitivity-test.html" class="card-link" style="background-color: #741736; color: black; width: 18rem; color: white; border-color: #741736;">
                <div class="card-body">
                    <h5 class="card-title">Transitivity Test</h5>
                </div>
            </a>
        </div>
<!-- Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<!-- Custom Scripts -->
<script src="https://www.vbl-s-mts.com/getUID.js"></script>
<script src="https://www.vbl-s-mts.com/testingFunctions.js"></script>
<script type="text/javascript">
    // Function to show/hide cards based on conditions
    function checkAndShowCards(variableValue, cardId) {
        if (variableValue == "true") {
            var card = document.getElementById(cardId);
            if (card) {
                card.style.display = "block";
            }
        }
        else
        {
           var card = document.getElementById(cardId);
            if (card) {
                card.style.display = "none";
            } 
        }
    }
    function checkAndHideCards(variableValue, cardId) {
        if (variableValue == "true") {
            var card = document.getElementById(cardId);
            if (card) {
                card.style.display = "none";
            }
        }
    }
    document.addEventListener("DOMContentLoaded", function() 
    {
        setTimeout(function(){
            $("#popupModal").modal("show");
        }, 500); // time in milliseconds
        var preTrainingVal = preTraining();
        var preSymVal = preSym();
        var preTransVal = preTrans();
        var BLVal = BL();
        var BLTestVal = BLTest();
        var SymVal = Symmetry();
        var TransVal = Trans();
        checkAndShowCards(preTrainingVal, "preSymmetry");
        checkAndShowCards(preSymVal, "preTrans")
        checkAndShowCards(preTransVal, "BL")
        checkAndShowCards(BLVal, "BLTest")
        checkAndShowCards(BLTest, "Symmetry")
        checkAndShowCards(SymVal, "Trans")
        checkAndHideCards(preTrainingVal, "preTraining")
        checkAndHideCards(preSymVal, "preSymmetry")
        checkAndHideCards(preTransVal, "preTrans")
        checkAndHideCards(BLVal, "BL")
        checkAndHideCards(BLTest, "BLTest")
        checkAndHideCards(SymVal, "Symmetry")
        checkAndHideCards(TransVal, "Trans")
        var droppedValue = getDroppedCookieValue();
        if (droppedValue === "true") {
            var cards = document.getElementsByClassName("card");
            for (var i = 0; i < cards.length; i++) 
            {
                cards[i].style.display = "none";
            }
            }
        });
        
        function instruction() {
            $(document).ready(function() {
            setTimeout(function(){
               $("#popupModal").modal("show");
            }, 500); // time in milliseconds
         });
    }
         
        function goBack() {
            window.history.back();
        }
            document.addEventListener("DOMContentLoaded", function() {
        // Get a reference to the close button
        var closeButton = document.querySelector(".btn.btn-danger[data-dismiss='modal']");
        // Add a click event listener to the close button
        closeButton.addEventListener("click", function() {
        // Close the modal by finding its parent modal element and calling the Bootstrap method to hide it
        var modal = document.querySelector("#popupModal");
        var bootstrapModal = bootstrap.Modal.getInstance(modal);
        bootstrapModal.hide();

        //this here makes a new user if one isn't found
        var userID = getUserId();
        if(userID === "")
        {
            startUp();
            var userId = generateUserId();
            document.cookie = "userId=" + userId + "; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"; // Expires far in the future
            
            //haven't been dropped yet best to not leave this cookie blank and have something mess up in checking for drops
            document.cookie = "dropped=false" + "; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/";

            // Send AJAX request to PHP script
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    console.log(this.responseText);
                }
            };
            xhttp.open("POST", "insertNewUser.php", true);
            xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhttp.send("userId=" + userId);
            console.log(userID);
        }
        function generateUserId() {
            var userId = "";
            for (var i = 0; i < 15; i++) 
            {
                userId += Math.floor(Math.random() * 10);
            }
            return userId;
                 
        }
     });
   });     
</script>
</body>
</html>